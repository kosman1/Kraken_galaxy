<tool id="krakentest" name="Kraken" version="0.10.3-beta">
    
    <requirements>
        <requirement type="package" version="0.10.3-beta">kraken</requirement>
    </requirements>
    
    <description>
        Kraken is a taxonomic sequence classifier that assigns taxonomic labels to short DNA reads.
    </description>
    
    <version_command>kraken -version</version_command>
    
    <command interpreter="bash">kraken --db $DBNAME $input > $output</command>
<!--    DATABASE INPUT-->
    <inputs>
<!--        <conditional name="krakenDatabaseSource">-->
<!--            <param name="kraken_database" type="select" label="Select a database" >-->
<!--                <option value="history">Use one from the history</option>-->
<!--            </param>-->
<!--            <when value="history">-->
<!--                <param name="ownFile" type="data" format="kraken_database" metadata_name="dbkey" label="Select the kraken index" />-->
<!--                <conditional name="IndexPrams">-->

<!--        <options from_data_table="bowtie_indexes"/>-->
<!--      </param>-->

<!--        MULTI FASTA SEQUENCES INPUT-->
        <param type="data" name="input" format="fa" />
    </inputs>
        
    <outputs>
<!--        CLASSIFIED SEQUENCES OUTPUT-->
        <data name="output" format="txt" from_work_dir="classified_seqs.txt" />
    </outputs>
    <tests>
        <test>
            <param name="input1" value="seqs.fa"/>
            <output name="output1" file="classified_seqs.txt"/>
        </test>
    </tests>
    
    <help>

       **What it does**

Kraken is a taxonomic sequence classifier that assigns taxonomic labels to short DNA reads. It does this by examining the k-mers within a read and querying a database with those k-mers. This database contains a mapping of every k-mer in Kraken's genomic library to the lowest common ancestor (LCA) in a taxonomic tree of all genomes that contain that k-mer. The set of LCA taxa that correspond to the k-mers in a read are then analyzed to create a single taxonomic label for the read; this label can be any of the nodes in the taxonomic tree. Kraken is designed to be rapid, sensitive, and highly precise. Our tests on various real and simulated data have shown Kraken to have sensitivity slightly lower than Megablast with precision being slightly higher. On a set of simulated 100 bp reads, Kraken processed over 1.3 million reads per minute on a single core in normal operation, and over 4.1 million reads per minute in quick operation.

    **Input formats**

        Usage: kraken [options] filename(s)

Options:
  --db NAME               Name for Kraken DB
  --threads NUM           Number of threads
  --fastq-input           Input is FASTQ, not FASTA format
  --quick                 Quick operation (use first hit or hits)
  --min-hits NUM          In quick op., number of hits req'd for classification
                          NOTE: this is ignored if --quick is not specified
  --unclassified-out FILENAME
                          Print unclassified sequences to filename
  --classified-out FILENAME
                          Print classified sequences to filename
  --output FILENAME       Print output to filename (def. is stdout); "-" will
                          suppress normal output
  --preload               Loads DB into memory before classification
  --help                  Print this message
  --version               Print version information

    </help>

    <citations>
      <citation type="doi">10.1186/gb-2014-15-3-r46</citation>
    </citations>
</tool>